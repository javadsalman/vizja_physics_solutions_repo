<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../../img/favicon.ico" rel="shortcut icon"/>
<title>Problem 2: Estimating π using Monte Carlo Methods - Physics and Mathematics</title>
<link href="../../../css/theme.css" rel="stylesheet"/>
<link href="../../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Problem 2: Estimating \u03c0 using Monte Carlo Methods";
        var mkdocs_page_input_path = "1 Physics/6 Statistics/Problem_2.md";
        var mkdocs_page_url = null;
      </script>
<!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../.."> Physics and Mathematics
        </a><div role="search">
<form action="../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../..">Introduction</a>
</li>
</ul>
<p class="caption"><span class="caption-text">1 Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal">1 Mechanics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_1/">Problem 1: Investigating the Range as a Function of the Angle of Projection</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_2/">Problem 2: Investigating the Dynamics of a Forced Damped Pendulum</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Gravity</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_1/">Problem 1: Orbital Period and Orbital Radius</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_2/">Problem 2: Escape Velocities and Cosmic Velocities</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_3/">Problem 3: Trajectories of a Freely Released Payload Near Earth</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Waves</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../3%20Waves/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Electromagnetism</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../4%20Electromagnetism/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Circuits</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../5%20Circuits/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal current">6 Statistics</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Problem_1/">Problem 1: Exploring the Central Limit Theorem through Simulations</a>
</li>
<li class="toctree-l2 current"><a class="reference internal current" href="#">Problem 2: Estimating π using Monte Carlo Methods</a>
<ul class="current">
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#part-1-estimating-using-a-circle">Part 1: Estimating π Using a Circle</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#theoretical-foundation">Theoretical Foundation</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#python-implementation">Python Implementation</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#results-and-analysis">Results and Analysis</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#part-2-estimating-using-buffons-needle">Part 2: Estimating π Using Buffon's Needle</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#theoretical-foundation_1">Theoretical Foundation</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#python-implementation_1">Python Implementation</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#results-and-analysis_1">Results and Analysis</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#comparison-of-methods">Comparison of Methods</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#practical-applications">Practical Applications</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#conclusion">Conclusion</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">7 Measurements</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../7%20Measurements/Problem_1/">Problem 1: Measuring Earth's Gravitational Acceleration with a Pendulum</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">2 Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/1%20Linear_algebra/">Linear Algebra</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/2%20Analytic_geometry/">Analytic geometry</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/3%20Calculus/">Calculus</a>
</li>
</ul>
<p class="caption"><span class="caption-text">3 Discret Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal">5 Logic</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/5%20Logic/_01%20Logic/">Logic</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../..">Physics and Mathematics</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../../.."></a></li>
<li class="breadcrumb-item">1 Physics</li>
<li class="breadcrumb-item">6 Statistics</li>
<li class="breadcrumb-item active">Problem 2: Estimating π using Monte Carlo Methods</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="problem-2-estimating-using-monte-carlo-methods">Problem 2: Estimating π using Monte Carlo Methods</h1>
<h2 id="introduction">Introduction</h2>
<p>Monte Carlo methods are powerful computational techniques that use randomness to solve problems or estimate values. In this problem, we explore two different approaches to estimate the value of π using Monte Carlo simulations:
1. The circle method (geometric probability)
2. Buffon's Needle method</p>
<h2 id="part-1-estimating-using-a-circle">Part 1: Estimating π Using a Circle</h2>
<h3 id="theoretical-foundation">Theoretical Foundation</h3>
<p>The circle method is based on the ratio of areas between a unit circle and its bounding square. For a unit circle (radius = 1) inscribed in a square of side length 2:</p>
<ul>
<li>Area of the circle: <span class="arithmatex">\(A_{circle} = \pi r^2 = \pi\)</span></li>
<li>Area of the square: <span class="arithmatex">\(A_{square} = (2r)^2 = 4\)</span></li>
</ul>
<p>The ratio of these areas is: <span class="arithmatex">\(\frac{A_{circle}}{A_{square}} = \frac{\pi}{4}\)</span></p>
<p>Therefore, if we randomly generate points in the square, the probability that a point falls inside the circle is <span class="arithmatex">\(\pi/4\)</span>. This leads to the estimation formula: <span class="arithmatex">\(\pi \approx 4 \cdot \frac{\text{points inside circle}}{\text{total points}}\)</span></p>
<h3 id="python-implementation">Python Implementation</h3>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
import os
from tqdm import tqdm

# Ensure the images directory exists
img_dir = os.path.join("docs", "1 Physics", "6 Statistics", "images")
os.makedirs(img_dir, exist_ok=True)

class CirclePiEstimator:
    """Estimator for π using the circle method"""

    def __init__(self, num_points=10000):
        """
        Initialize the estimator.

        Parameters:
        - num_points: number of random points to generate
        """
        self.num_points = num_points
        self.points = np.random.uniform(-1, 1, (num_points, 2))
        self.inside = np.sum(self.points[:, 0]**2 + self.points[:, 1]**2 &lt;= 1)
        self.pi_estimate = 4 * self.inside / num_points

    def plot_points(self, filename=None):
        """Plot the random points and circle"""
        plt.figure(figsize=(8, 8))

        # Plot points
        inside = self.points[:, 0]**2 + self.points[:, 1]**2 &lt;= 1
        plt.scatter(self.points[inside, 0], self.points[inside, 1], 
                   c='blue', alpha=0.5, label='Inside circle')
        plt.scatter(self.points[~inside, 0], self.points[~inside, 1], 
                   c='red', alpha=0.5, label='Outside circle')

        # Plot circle
        theta = np.linspace(0, 2*np.pi, 100)
        plt.plot(np.cos(theta), np.sin(theta), 'k-', linewidth=2)

        # Plot square
        plt.plot([-1, 1, 1, -1, -1], [-1, -1, 1, 1, -1], 'k-', linewidth=2)

        plt.title(f'π Estimation: {self.pi_estimate:.6f} (n={self.num_points})')
        plt.xlabel('x')
        plt.ylabel('y')
        plt.axis('equal')
        plt.legend()
        plt.grid(True, alpha=0.3)

        if filename:
            save_path = os.path.join(img_dir, filename)
            plt.savefig(save_path, dpi=300, bbox_inches='tight')
            plt.close()
            return save_path

        return plt.gcf()

def run_circle_simulation(num_points_list):
    """Run simulation for different numbers of points"""
    results = []
    for n in tqdm(num_points_list, desc="Running circle simulation"):
        estimator = CirclePiEstimator(n)
        results.append({
            'n': n,
            'pi_estimate': estimator.pi_estimate,
            'error': abs(estimator.pi_estimate - np.pi)
        })
        if n in [100, 1000, 10000, 100000]:
            estimator.plot_points(f'circle_pi_n{n}.png')
    return results
</code></pre>
<h3 id="results-and-analysis">Results and Analysis</h3>
<p><img alt="Circle Method - n=100" src="../images/circle_pi_n100.png"/></p>
<p><em>Figure 1: π estimation with 100 points</em></p>
<p><img alt="Circle Method - n=10000" src="../images/circle_pi_n10000.png"/></p>
<p><em>Figure 2: π estimation with 10,000 points</em></p>
<p><strong>Key Observations:</strong>
- The estimate improves as the number of points increases
- The error decreases approximately as <span class="arithmatex">\(1/\sqrt{n}\)</span> (standard Monte Carlo convergence)
- The method is simple to implement but requires many points for high precision</p>
<h2 id="part-2-estimating-using-buffons-needle">Part 2: Estimating π Using Buffon's Needle</h2>
<h3 id="theoretical-foundation_1">Theoretical Foundation</h3>
<p>Buffon's Needle is a classic probability experiment where a needle of length <span class="arithmatex">\(l\)</span> is dropped onto a plane with parallel lines spaced <span class="arithmatex">\(d\)</span> units apart. The probability that the needle crosses a line is:</p>
<p><span class="arithmatex">\(P = \frac{2l}{\pi d}\)</span></p>
<p>If we drop the needle <span class="arithmatex">\(n\)</span> times and observe <span class="arithmatex">\(c\)</span> crossings, we can estimate π as:</p>
<p><span class="arithmatex">\(\pi \approx \frac{2l \cdot n}{d \cdot c}\)</span></p>
<h3 id="python-implementation_1">Python Implementation</h3>
<pre><code class="language-python">class BuffonNeedle:
    """Estimator for π using Buffon's Needle method"""

    def __init__(self, needle_length=1, line_spacing=2, num_throws=10000):
        """
        Initialize the estimator.

        Parameters:
        - needle_length: length of the needle
        - line_spacing: distance between parallel lines
        - num_throws: number of needle throws
        """
        self.needle_length = needle_length
        self.line_spacing = line_spacing
        self.num_throws = num_throws

        # Generate random needle positions
        self.x = np.random.uniform(0, line_spacing, num_throws)
        self.theta = np.random.uniform(0, np.pi, num_throws)

        # Calculate crossings
        self.crossings = self.x + 0.5 * needle_length * np.sin(self.theta) &gt; line_spacing
        self.crossings += self.x - 0.5 * needle_length * np.sin(self.theta) &lt; 0

        self.pi_estimate = (2 * needle_length * num_throws) / (line_spacing * np.sum(self.crossings))

    def plot_needles(self, max_needles=100, filename=None):
        """Plot the needle positions"""
        plt.figure(figsize=(10, 6))

        # Plot lines
        for i in range(0, int(self.line_spacing * 2) + 1):
            plt.axhline(y=i, color='k', linestyle='-', alpha=0.5)

        # Plot needles
        n = min(max_needles, self.num_throws)
        for i in range(n):
            x1 = self.x[i] - 0.5 * self.needle_length * np.cos(self.theta[i])
            x2 = self.x[i] + 0.5 * self.needle_length * np.cos(self.theta[i])
            y1 = i % self.line_spacing
            y2 = y1 + self.needle_length * np.sin(self.theta[i])

            color = 'red' if self.crossings[i] else 'blue'
            plt.plot([x1, x2], [y1, y2], color=color, alpha=0.5)

        plt.title(f'Buffon\'s Needle: π ≈ {self.pi_estimate:.6f} (n={self.num_throws})')
        plt.xlabel('x')
        plt.ylabel('y')
        plt.grid(True, alpha=0.3)

        if filename:
            save_path = os.path.join(img_dir, filename)
            plt.savefig(save_path, dpi=300, bbox_inches='tight')
            plt.close()
            return save_path

        return plt.gcf()

def run_buffon_simulation(num_throws_list):
    """Run simulation for different numbers of throws"""
    results = []
    for n in tqdm(num_throws_list, desc="Running Buffon's Needle simulation"):
        estimator = BuffonNeedle(num_throws=n)
        results.append({
            'n': n,
            'pi_estimate': estimator.pi_estimate,
            'error': abs(estimator.pi_estimate - np.pi)
        })
        if n in [100, 1000, 10000, 100000]:
            estimator.plot_needles(filename=f'buffon_pi_n{n}.png')
    return results
</code></pre>
<h3 id="results-and-analysis_1">Results and Analysis</h3>
<p><img alt="Buffon's Needle - n=100" src="../images/buffon_pi_n100.png"/></p>
<p><em>Figure 3: Buffon's Needle with 100 throws</em></p>
<p><img alt="Buffon's Needle - n=10000" src="../images/buffon_pi_n10000.png"/></p>
<p><em>Figure 4: Buffon's Needle with 10,000 throws</em></p>
<p><strong>Key Observations:</strong>
- The estimate improves with more needle throws
- The convergence rate is similar to the circle method
- The method is more complex to implement but has historical significance</p>
<h2 id="comparison-of-methods">Comparison of Methods</h2>
<p>Let's compare both methods in terms of accuracy and computational efficiency:</p>
<pre><code class="language-python">def compare_methods():
    """Compare both methods"""
    num_points = [100, 1000, 10000, 100000, 1000000]

    # Run both simulations
    circle_results = run_circle_simulation(num_points)
    buffon_results = run_buffon_simulation(num_points)

    # Plot comparison
    plt.figure(figsize=(10, 6))
    plt.plot([r['n'] for r in circle_results], 
             [r['error'] for r in circle_results], 
             'b-', label='Circle Method')
    plt.plot([r['n'] for r in buffon_results], 
             [r['error'] for r in buffon_results], 
             'r-', label='Buffon\'s Needle')

    plt.xscale('log')
    plt.yscale('log')
    plt.xlabel('Number of points/throws')
    plt.ylabel('Absolute error')
    plt.title('Comparison of π Estimation Methods')
    plt.legend()
    plt.grid(True, alpha=0.3)

    save_path = os.path.join(img_dir, 'pi_estimation_comparison.png')
    plt.savefig(save_path, dpi=300, bbox_inches='tight')
    plt.close()

    return circle_results, buffon_results
</code></pre>
<p><img alt="Comparison of Methods" src="../images/pi_estimation_comparison.png"/></p>
<p><em>Figure 5: Comparison of both methods</em></p>
<h2 id="practical-applications">Practical Applications</h2>
<p>Monte Carlo methods have numerous applications beyond π estimation:</p>
<ol>
<li><strong>Physics:</strong></li>
<li>Particle transport simulations</li>
<li>Quantum mechanics calculations</li>
<li>
<p>Statistical mechanics</p>
</li>
<li>
<p><strong>Finance:</strong></p>
</li>
<li>Option pricing</li>
<li>Risk assessment</li>
<li>
<p>Portfolio optimization</p>
</li>
<li>
<p><strong>Computer Science:</strong></p>
</li>
<li>Randomized algorithms</li>
<li>Probabilistic data structures</li>
<li>
<p>Machine learning</p>
</li>
<li>
<p><strong>Engineering:</strong></p>
</li>
<li>Reliability analysis</li>
<li>Quality control</li>
<li>System simulation</li>
</ol>
<h2 id="conclusion">Conclusion</h2>
<p>Both Monte Carlo methods provide interesting ways to estimate π, each with its own advantages:</p>
<ol>
<li><strong>Circle Method:</strong></li>
<li>Simpler to implement</li>
<li>More intuitive</li>
<li>
<p>Better for visualization</p>
</li>
<li>
<p><strong>Buffon's Needle:</strong></p>
</li>
<li>Historical significance</li>
<li>Demonstrates geometric probability</li>
<li>More complex but equally effective</li>
</ol>
<p>The key insights from this study are:
- Monte Carlo methods can provide good estimates with sufficient samples
- The error decreases as <span class="arithmatex">\(1/\sqrt{n}\)</span> for both methods
- Visualization helps understand the convergence process
- Both methods demonstrate the power of random sampling in numerical computation</p>
<p>These methods serve as excellent introductions to Monte Carlo techniques and their applications in various fields of science and engineering.</p>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../Problem_1/" title="Problem 1: Exploring the Central Limit Theorem through Simulations"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../../7%20Measurements/Problem_1/" title="Problem 1: Measuring Earth's Gravitational Acceleration with a Pendulum">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../Problem_1/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../../7%20Measurements/Problem_1/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script src="../../../js/jquery-3.6.0.min.js"></script>
<script>var base_url = "../../..";</script>
<script src="../../../js/theme_extra.js"></script>
<script src="../../../js/theme.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script src="../../../search/main.js"></script>
<script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>
</body>
</html>
